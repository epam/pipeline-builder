language: node_js
node_js: "6"
os: linux
dist: trusty
before_install: 
    -LAST_PUBLISHED="$(npm view pipeline-builder-test@dev dev version)"
    -CURRENT_VERSION="$(npm version | grep -Po '(?<="pipeline-builder-test": ")[^"]*')"
    -if [ "$LAST_PUBLISHED" == "$CURRENT_VERSION" ]; then exit(1); fi
install: 
    - yarn global add gulp-cli
    - yarn install
script: gulp
after_script: gulp test:coveralls
before_deploy:
    - "npm version patch"
deploy:
    provider: npm
    email: "dsavchuk93@yandex.ru"
    api_key: "84251c56-7dcc-496d-8661-9529f5711868"
    on:
        branch: dev
after_deploy:
    - "curl \"http://35.164.165.183:8080/job/pipeline-wdl-builder/build?token=testpbbuild\""
